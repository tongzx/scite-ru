<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=windows-1251">
<meta name="generator" content="SciTE">

<title>Shell</title>
<style type="text/css">
body, td {FONT:x-small Verdana;}
table    {border:1px solid #1F1F1F; border-collapse:collapse;}
td,th    {border:1px solid #1F1F1F; padding:1px 5px 1px 5px;}
th       {background:#CCEEFF; color:#000080; font-size:x-small; text-align:left;}

a       {text-decoration:none;}
a:hover {background-color:#DDDDDD;}
a.tmenu {white-space:nowrap;}

h3 {
	color:#333399;
	border: 2px solid #FFCC00;
	background-color: #FFF7EE;
	padding: 2px 5px;
}

i     {font-weight:normal;}
em    {background-color:#F0FFF0;}
pre   {font-size:x-small; background-color:#F0FFFF;}
dfn   {color:#990099; font-weight:bold;}
var   {color:#333399; font-weight:bold; white-space:nowrap;}
code  {font-size:x-small; color:#333399; white-space:nowrap;}
cite  {color:#333399; font:menu;}

.cursor      {color:red;}
.windowsonly {background: #EBF3FF;}
.gtkonly     {background: #FFFFE7;}
.ruboardonly {background: #FFECFF;}

div.example {
	background: #F7FCF7;
	border: 1px solid #C0D7C0;
	margin: 0.3em 3em;
	padding: 0.3em 0.6em;
	font-family:Courier New;
	color:#333399;
}

span.example {
	background: #F7FCF7;
	font-family:Courier New;
	color:#333399;
}

table.tmenu {
	border-width:0;
}

.tmenu td {
	border-width:0;
	text-align:center;
	font-size:xx-small;
	font-weight:bold;
	color:white;
}

.tmenu a {color:#333399; white-space:nowrap;}
.tmenu a:hover {background-color:#F0F0F0;}

.head {font-size:110%; background-color:#D0E8E8;}
.author {text-align:right; font-size:80%}
sup {color:red;font-family:MS Sans Serif; font-weight:bold;}
</style>
</head>

<body bgcolor="white">
<table class="tmenu" width="100%"><tr><td>
  <table bgcolor="#000000" width="100%" cellspacing="4" cellpadding="0" border="0" summary="banner">
    <tr>
      <td><img src="../../doc/SciTEIco.png" height="64" width="64" alt="Scintilla icon"></td>
      <td width="100%"><font size="5">Shell - Lua library for SciTE</font></td>
    </tr>
  </table>
</td></tr></table>

<h3>Description</h3>

<p>External Lua library expanding opportunities SciTE Lua Scripting Extension.</p>

<h3>DLL loading</h3>

<p>Before use of library functions it require load:
<div class="example">
package.cpath = props["SciteDefaultHome"].."\\tools\\LuaLib\\?.dll;"..package.cpath<br>
-- show all paths on which SciTE will search for our library<br>
print(package.cpath)<br>
-- library loading<br>
require 'shell'<br>
-- test dll<br>
if shell then<br>
&nbsp;&nbsp;print("Load shell.dll")<br>
end
</div></p>

<h3>Functions</h3>

<table width="100%" cellpadding="1" cellspacing="0" border="1">

<tr><td>
	<p class="head">
		<dfn>msgbox (strMessageText, [strTitle], [intOptions])</dfn>
	</p>
	<p>
		<b>Description:</b><br>
		&nbsp;&nbsp;Showing text message with buttons.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strMessageText</dfn> - text message<br>
		&nbsp;&nbsp;<dfn>strTitle</dfn> - title text of message<br>
		&nbsp;&nbsp;<dfn>intOptions</dfn> - numerical expression representing the sum of values, listed in the table.
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Value</th><th>Description</th></tr>
		<tr>
		<td align="center">0</td>
		<td>Display OK button only (default)</td>
		</tr>
		<tr>
		<td align="center">1</td>
		<td>Display OK and Cancel buttons</td>
		</tr>
		<tr>
		<td align="center">2</td>
		<td>Display Abort, Retry, and Ignore buttons</td>
		</tr>
		<tr>
		<td align="center">3</td>
		<td>Display Yes, No, and Cancel buttons</td>
		</tr>
		<tr>
		<td align="center">4</td>
		<td>Display Yes and No buttons</td>
		</tr>
		<tr>
		<td align="center">5</td>
		<td>Display Retry and Cancel buttons</td>
		</tr>
		<tr>
		<td align="center">16</td>
		<td>Display Critical Message icon</td>
		</tr>
		<tr>
		<td align="center">32</td>
		<td>Display Question Message icon</td>
		</tr>
		<tr>
		<td align="center">48</td>
		<td>Display Exclamation Message icon</td>
		</tr>
		<tr>
		<td align="center">64</td>
		<td>Display Information Message icon</td>
		</tr>
		<tr>
		<td align="center">0</td>
		<td>First button is the default</td>
		</tr>
		<tr>
		<td align="center">256</td>
		<td>Second button is the default</td>
		</tr>
		<tr>
		<td align="center">512</td>
		<td>Third button is the default</td>
		</tr>
		<tr>
		<td align="center">768</td>
		<td>Fourth button is the default</td>
		</tr>
		<tr>
		<td align="center">0</td>
		<td>Application modal. The user must respond to the message box before continuing work in the current application.</td>
		</tr>
		<tr>
		<td align="center">4096</td>
		<td>System modal. On Win16 systems, all applications are suspended until the user responds to the message box. On Win32 systems, this constant provides an application modal message box that always remains on top of any other programs you may have running.</td>
		</tr>
		</table>
	</p>
	<br>
	<p>
	<b>Return value:</b><br>
		&nbsp;&nbsp;Returned code to identify which button a user has selected. Values are listed in the table:
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Value</th><th>Description</th></tr>
		<tr>
		<td align="center">1</td>
		<td>OK button was clicked</td>
		</tr>
		<tr>
		<td align="center">2</td>
		<td>Cancel button was clicked</td>
		</tr>
		<tr>
		<td align="center">3</td>
		<td>Abort button was clicked</td>
		</tr>
		<tr>
		<td align="center">4</td>
		<td>Retry button was clicked</td>
		</tr>
		<tr>
		<td align="center">5</td>
		<td>Ignore button was clicked</td>
		</tr>
		<tr>
		<td align="center">6</td>
		<td>Yes button was clicked</td>
		</tr>
		<tr>
		<td align="center">7</td>
		<td>No button was clicked</td>
		</tr>
		</table>
	</p>
		<p><b>Example:</b>
		<div class="example">
		if shell.msgbox("You are sure?", "SciTE", 65) == 1 then<br>
		&nbsp;&nbsp;print("Yes")<br>
		end<br>
		</div>
		</p>
	<p class="author">Authors: Midas, mimir</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>getfileattr (strFileName)</dfn>
	</p>
	<p>
	<b>Description:</b><br>
		&nbsp;&nbsp;Get file attributes.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - filename<br>
		<br>
	<b>Return value:</b><br>
		&nbsp;&nbsp;contains file attributes as number<br>
	</p>
		<p><b>Example:</b>
		<div class="example">
		local attr = shell.getfileattr("c:\\MSDOS.SYS")<br>
		print(attr)
		</div>
		</p>
	<p class="author">Authors: Midas, Dmitry Maslov</p>
</td></tr>

<tr><td>
	<p class="head">
		<dfn>setfileattr (strFileName, intFileAttr)</dfn>
	</p>
	<p>
	<b>Description:</b><br>
		&nbsp;&nbsp;Set file attributes.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - filename<br>
		&nbsp;&nbsp;<dfn>iFileAttr</dfn> - file attributes as number<br>
		<br>
	<b>Return value:</b><br>
		&nbsp;&nbsp;contains <var>true</var> (at successful end) or <var>false</var> (at failure)<br>
	</p>
		<p><b>Example:</b>
		<div class="example">
		local result = shell.setfileattr("c:\\MSDOS.SYS", 32)<br>
		if result == true then<br>
		&nbsp;&nbsp;print("File attributes are successfully established")<br>
		else<br>
		&nbsp;&nbsp;print("error")<br>
		end
		</div>
		</p>
	<p class="author">Authors: Midas, Dmitry Maslov</p>
</td></tr>

<tr><td>
	<p class="head"> <sup>new</sup>
		<dfn>fileexists (strFileName)</dfn>
	</p>
	<p>
	<b>Description:</b><br>
		&nbsp;&nbsp;Check exist file or folder with specified name.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strFileName</dfn> - filename or folder name<br>
		<br>
	<b>Return value:</b><br>
		&nbsp;&nbsp;contains <var>true</var> if file (folder) exist or <var>false</var> otherwise<br>
	</p>
		<p><b>Example:</b>
		<div class="example">
		local result = shell.fileexists("c:\\MSDOS.SYS")<br>
		if result then<br>
		&nbsp;&nbsp;print("File exist")<br>
		else<br>
		&nbsp;&nbsp;print("File not found")<br>
		end
		</div>
		</p>
	<p class="author">Author: VladVRO</p>
</td></tr>

<tr><td>
	<p class="head"> <sup>new</sup>
		<dfn>exec (strCommand, [strOperation], [boolNoShow], [bWaitOnReturn])</dfn>
	</p>
	<p>
	<b>Description:</b><br>
		&nbsp;&nbsp;Run external programm or open file with associate application. Allows to execute files, documents and links and to open folders in Windows Explorer.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strCommand</dfn> - filename or folder with possible startup parameters. Can contain <nobr>%environments_variable%</nobr><br>
		&nbsp;&nbsp;<dfn>strOperation</dfn> - executed operation from listed in the table:<br>
		<table style="margin-left:8pt;margin-top:3pt">
		<tr><th>Operation</th><th>Description</th></tr>
		<tr>
		<td align="center">open</td>
		<td>Open. strCommand - filename or folder name (default)</td>
		</tr>
		<tr>
		<td align="center">edit</td>
		<td>Edit. Opens a file for editing. strCommand should be the document.</td>
		</tr>
		<tr>
		<td align="center">print</td>
		<td>Print. strCommand should be the document.</td>
		</tr>
		<tr>
		<td align="center">explore</td>
		<td>Opens a folder in Explorer window (with two panels). strCommand - file or folder</td>
		</tr>
		<td align="center">select</td>
		<td>Opens a folder in Explorer window and chooses the specified folder or a file. strCommand - file or folder</td>
		</tr>
		<tr>
		<td align="center">find</td>
		<td>Showing a dialog box "File Search". strCommand should specify a folder path from which search will begin</td>
		</tr>
		<td align="center">properties</td>
		<td>Showing file|folder "Properties" window. strCommand - file or folder</td>
		</tr>
		<td align="center">other</td>
		<td>Other operation available in context menu of a file. For example "Play" operation available for media files.</td>
		</tr>
		</table>
		<br>
		&nbsp;&nbsp;<dfn>boolNoShow</dfn> - <var>true</var> | <var>false</var> (default) - silent or show a window of the started program<br>
		&nbsp;&nbsp;<dfn>bWaitOnReturn</dfn> - <var>true</var> | <var>false</var> (default) - boolean value indicating whether the script should wait for the program to finish executing before continuing to the next statement in your script<br>
	<br>
	<b>Return value:</b><br>
		&nbsp;&nbsp;The first contains<br>
		&nbsp;&nbsp;&nbsp;&nbsp;- at successful end: <var>true</var> or (if function has been started with parameter <var>bWaitOnReturn = true</var>), exit code of process<br>
		&nbsp;&nbsp;&nbsp;&nbsp;- at failure: <var>false</var><br>
		&nbsp;&nbsp;The second value contains error/success message of operation;<br>
		&nbsp;&nbsp;or contains the output text of the console application (if execute console applications with parameters <var>boolNoShow = true</var> and <var>bWaitOnReturn = true</var>)
	</p>
		<p><b>Example:</b>
		<div class="example">
			-- run application<br>
			shell.exec("clipbrd.exe")<br>
			shell.exec("CMD /c IPCONFIG /all > out.txt", nil, true, false)<br>
			<br>
			-- show result of console application<br>
			print( shell.exec("CMD /c DIR", nil, true, true) )<br>
			print( shell.exec("cscript /nologo %WINDIR%\\system32\\eventquery.vbs /?", nil, true, true) )<br>
			<br>
			-- analysis of the exit code of process<br>
			if shell.exec("ping -n 1 localhost", nil, true, true) == 0 then<br>
			&nbsp;&nbsp;&nbsp;&nbsp;print("Network works") else print("Network does not work")<br>
			end<br>
			<br>
			-- open folder<br>
			shell.exec("%TEMP%")<br>
			shell.exec("%USERPROFILE%", "find")<br>
			shell.exec("%WINDIR%\\regedit.exe", "explore")<br>
			shell.exec("%ProgramFiles%", "properties")<br>
			shell.exec("%ComSpec%", "select")<br>
			<br>
			-- open URL link<br>
			shell.exec("http://scite.ruteam.ru/")<br>
			<br>
			-- send e-mail<br>
			shell.exec("mailto:support@gmail.com")<br>
			<br>
			-- open file (with associate application)<br>
			shell.exec("%WINDIR%\\WindowsUpdate.log")<br>
			<br>
			-- print file<br>
			shell.exec("%WINDIR%\\win.ini", "print")<br>
			<br>
			-- edit file<br>
			shell.exec("%WINDIR%\\winnt.bmp", "edit")
		</div>
		</p>
	<p class="author">Authors: Dmitry Maslov</p>
</td></tr>

<tr><td>
	<p class="head"> <sup>new</sup>
		<dfn>findfiles (strFindMask)</dfn>
	</p>
	<p>
	<b>Description:</b><br>
		&nbsp;&nbsp;Ищет файлы и папки по маске и результат возвращает в виде таблицы.<br>
	<br>
	<b>Parameters:</b><br>
		&nbsp;&nbsp;<dfn>strFindMask</dfn> - имя файла или папки, или маска с использованием группового символа (wildcard), который заменяет один или несколько символов: знак вопроса (<var>?</var>) может представлять любой одиночный символ; звездочка (<var>*</var>) используется для представления любого символа или группы символов.<br>
		<br>
	<b>Return value:</b><br>
		&nbsp;&nbsp;Возвращает список найденных файлов и папок в виде нумерованной таблицы (нумерация начиается с <var>1</var>), где<br>
		&nbsp;&nbsp;каждый элемент - структура содержащая:<br>
		<table style="margin-left:8pt;margin-top:3pt;margin-bottom:3pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
			<td align="left">name</td>
			<td>имя папки или файла</td>
		</tr>
		<tr>
			<td align="left">isdirectory</td>
			<td>признак файл это или папка (<var>true</var> если папка, <var>false</var> если файл)</td>
		</tr>
		<tr>
			<td align="left">attributes</td>
			<td>атрибуты файла (см. ниже)</td>
		</tr>
		<tr>
			<td align="left">size</td>
			<td>размер файла в байтах</td>
		</tr>
		</table>
		&nbsp;&nbsp;атрибуты файла представлены в виде числа, которое может быть комбинацией следующих значений:<br>
		<table style="margin-left:8pt;margin-top:3pt;margin-right:8pt">
		<tr><th>Значение</th><th>Описание</th></tr>
		<tr>
			<td>0x00000001</td>
			<td>Файл только для чтения. Приложения могут читать такой файл, но не могут записывать или удалять его.</td>
		</tr>
		<tr>
			<td>0x00000002</td>
			<td>Файл скрыт. Такой файл не включается в обычный листинг каталога.</td>
		</tr>
		<tr>
			<td>0x00000004</td>
			<td>Это системный файл. Обычно такой файл является частью операционной системы.</td>
		</tr>
		<tr>
			<td>0x00000010</td>
			<td>Это каталог.</td>
		</tr>
		<tr>
			<td>0x00000020</td>
			<td>Это архивный файл. Приложения должны использовать этот флаг для копирования, архивирования или удаления.</td>
		</tr>
		<tr>
			<td>0x00000080</td>
			<td>У этого файла не установлены другие атрибуты. Это значение корректно только при использовании без остальных флагов.</td>
		</tr>
		<tr>
			<td>0x00000100</td>
			<td>Это временный файл. Приложения должны записывать в такой файл только в крайней необходимости. Большая часть данных файла находится в памяти и не сбрасывается на диск, так как файл будет удален.</td>
		</tr>
		<tr>
			<td>0x00000200</td>
			<td>Файл является т.н. "Sparse file".</td>
		</tr>
		<tr>
			<td>0x00000400</td>
			<td>Каталог является символической связью.</td>
		</tr>
		<tr>
			<td>0x00000800</td>
			<td>Файл или каталог сжат. Для файла это означает, что все данные его сжаты, для каталога - что компрессия по умолчанию применяется ко всем его файлам и подкаталогам.</td>
		</tr>
		<tr>
			<td>0x00001000</td>
			<td>Данные файла не доступны непосредственно. Означает, что реальные данные файла были физически перемещены на устройства хранения.</td>
		</tr>
		<tr>
			<td>0x00002000</td>
			<td>Этот файл или каталог не будут индексироваться службой индексирования.</td>
		</tr>
		<tr>
			<td>0x00004000</td>
			<td>Файл или каталог зашифрован. Для файла, это означает, что все данные в файле зашифрованы. Для директория, это означает, что шифрование является умолчанием для вновь созданных файлов и подкаталогов.</td>
		</tr>
		<tr>
			<td>0x00010000</td>
			<td>Это виртуальный файл.</td>
		</tr>
		</table>
		<br>
		&nbsp;&nbsp;В случае неудачи возвращает <var>nil</var>
	</p>
		<p><b>Example:</b>
		<div class="example">
		local t = shell.findfiles("C:\\*")<br>
		if t then<br>
		&nbsp;&nbsp;table.sort(t,<br>
		&nbsp;&nbsp;&nbsp;&nbsp;function(v1,v2)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if v1.isdirectory ~= v2.isdirectory then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return v1.isdirectory<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return v1.name:lower() &lt; v2.name:lower()<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;)<br>
		&nbsp;&nbsp;table.foreachi(t,<br>
		&nbsp;&nbsp;&nbsp;&nbsp;function(i,v)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if v.isdirectory then<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(string.format("D%5x %s", v.attributes, v.name))<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(string.format(" %5x %-30s", v.attributes, v.name), v.size)<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;&nbsp;&nbsp;end<br>
		&nbsp;&nbsp;)<br>
		else<br>
		&nbsp;&nbsp;print("not found")<br>
		end<br>
		</div>
		</p>
	<p class="author">Author: VladVRO</p>
</td></tr>

</table>

<h3>Download</h3>

<p><u>Current version Shell</u>: <var>1.2</var><br></p>
<p>
<a href="http://scite-ru.googlecode.com/svn/trunk/pack/tools/LuaLib/shell.dll">shell.dll</a><br>
<a href="http://scite-ru.googlecode.com/svn/trunk/shell/">Source code</a>
</p>

</body>
</html>
